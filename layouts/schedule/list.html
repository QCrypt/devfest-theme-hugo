{{ define "main" }}

{{ $lang := $.Page.Language.Lang }}


<section class="schedule">
	{{ range $day := $.Site.Data.schedule }}
	{{ $time := split $day.start ":" }}
	{{ $dayStartH := index $time 0 }}
	{{ $dayStartM := index $time 1 }}
	{{ $time := split $day.end ":" }}
	{{ $dayEndH := index $time 0 }}
	{{ $dayEndM := index $time 1 }}

	<article id="day_{{$day.day}}" class="day">
		<nav class="day-tabs">
			{{ range $day := $.Site.Data.schedule }}
			<a href="#day_{{$day.day}}">{{- partial "date-long.html" (dict "time" .day "lang" $lang) }}</a>
			{{ end }}
		</nav>

		<span class="timezone">
			Schedule is still subject to change. Times are shown in: Central European Time - Amsterdam.
		</span>

		<ul class="talks">
			{{ range $session := $day.sessions }}
			{{ $sessionPage := $.Site.GetPage (path.Join "/sessions" $session.session) }}
			{{ $time := split $session.time ":" }}
			{{ $hh := index $time 0 }}
			{{ $mm := index $time 1 }}


				<div class="session tag-{{ anchorize (delimit ($sessionPage.Params.tags | default (slice)) " " ) }}">
					<span class="startt">
						<span class="hh">{{ $hh }}</span>
						<span class="mm">{{ $mm }}</span>
					</span>
					{{ partial "schedule-session" $sessionPage }}
				</div>


			{{ end }}
		</ul>

	</article>
	{{ end }}

</section>

<!--<a href="#" class="goto-top" aria-label="Top">⬆︎</a>-->

{{ .Content }}

{{ end }}

{{ define "scripts" }}
<script>
function checkLinks() {
    const currentDay = document.location.hash;
    if (!currentDay) {
        let firstDay = document.querySelector('nav.day-tabs a');
        if (firstDay) {
            firstDay.click();
        }
    }
    document.querySelectorAll('nav.day-tabs a')
        .forEach(function(lnk) {
            lnk.classList.toggle('active', lnk.getAttribute('href') === currentDay);
        });
}
window.addEventListener("load", checkLinks, false);
window.addEventListener("hashchange", checkLinks, false);
</script>
{{ end }}
